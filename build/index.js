!function(e){var t={};function i(l){if(t[l])return t[l].exports;var n=t[l]={i:l,l:!1,exports:{}};return e[l].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=e,i.c=t,i.d=function(e,t,l){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(i.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(l,n,function(t){return e[t]}.bind(null,n));return l},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=3)}([function(e,t){!function(){e.exports=this.wp.element}()},function(e,t){!function(){e.exports=this.regeneratorRuntime}()},function(e,t){function i(e,t,i,l,n,r,a){try{var o=e[r](a),s=o.value}catch(e){return void i(e)}o.done?t(s):Promise.resolve(s).then(l,n)}e.exports=function(e){return function(){var t=this,l=arguments;return new Promise((function(n,r){var a=e.apply(t,l);function o(e){i(a,n,r,o,s,"next",e)}function s(e){i(a,n,r,o,s,"throw",e)}o(void 0)}))}}},function(e,t,i){"use strict";i.r(t);var l=i(1),n=i.n(l),r=i(2),a=i.n(r),o=i(0),s=wp.i18n,u=s.__,c=(s.setLocaleData,wp.blocks.registerBlockType),h=wp.blockEditor,m=h.RichText,d=h.MediaUpload,g=h.InspectorControls,b=wp.components,p=b.Button,f=b.TextControl,w=b.PanelBody,x=b.RadioControl,y=function(e){var t=e.split("."),i=t[t.length-1];return t.pop(),{trunc:t.join("."),extension:i}},v=function(e){var t=y(e).trunc;return t.lastIndexOf("-scaled")===t.length-7},z=function(e){var t=y(e);return t.trunc.substring(0,t.trunc.length-7)+"."+t.extension},O=function(e){var t,i,l=e.originalWidth/e.originalHeight,n=y(e.url),r=n.extension,a=n.trunc,o=(t=a.split("-"),i=t[t.length-1].split("x"),t.pop(),{width:i[0],height:i[1],withoutSizesTrunc:t.join("-")}),s=o.width,u=o.withoutSizesTrunc,c=[];return e.scaleList.forEach((function(t,i){var n=Math.round(s*t);if(n<=e.originalWidth){var a=Math.round(n/l),o=u+"-"+n+"x"+a+"."+r;c.push({url:o,width:n,height:a})}})),c},j=function(e){return new Promise((function(t,i){var l=document.createElement("img");l.onload=function(){t({width:l.width,height:l.height}),l.remove},l.onerror=function(t){i('Error on loading image "'+e+'"',t)},l.src=e,document.body.appendChild(l)}))},E=function(e){return new Promise((function(t,i){var l=new XMLHttpRequest;l.open("HEAD",e,!0),l.onreadystatechange=function(){4==l.readyState&&(200==l.status?t(!0):t(!1))},l.send(null)}))};c("bsx-blocks/lazy-img",{title:u("BSX Lazy Image","bsx-blocks"),icon:"format-image",category:"layout",attributes:{hasFigure:{boolean:"string",default:!0},textAlign:{type:"string",default:""},imgSizes:{type:"array",default:[]},imgSizeIndex:{type:"string",default:"3"},imgId:{type:"number"},smallMobileUrl:{type:"string"},smallMobileWidth:{type:"number"},smallMobileHeight:{type:"number"},mobileUrl:{type:"string"},mobileWidth:{type:"number"},mobileHeight:{type:"number"},url:{type:"string"},width:{type:"number"},height:{type:"number"},origWidth:{type:"number"},origHeight:{type:"number"},lowestSrcsetImgSizeIndex:{type:"number",default:1},alt:{type:"string"},figcaption:{type:"array",source:"children",selector:"figcaption"}},edit:function(e){var t=e.className,i=e.attributes,l=i.imgId,r=i.imgSizes,s=i.imgSizeIndex,c=i.smallMobileUrl,h=i.smallMobileWidth,b=i.smallMobileHeight,y=i.mobileUrl,S=i.mobileWidth,k=i.mobileHeight,M=i.url,I=i.width,H=i.height,W=(i.origWidth,i.origHeight,i.lowestSrcsetImgSizeIndex),C=i.alt,P=i.figcaption,N=e.setAttributes,U=e.isSelected;e.setState;function T(e){return _.apply(this,arguments)}function _(){return(_=a()(n.a.mark((function e(t){var i,l,r,a,o,u,c,h,m,d,g,b,p;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t.url){e.next=40;break}if(i="",l=0,r=0,!v(t.url)){e.next=19;break}return i=z(t.url),e.prev=6,e.next=9,j(i);case 9:a=e.sent,e.next=15;break;case 12:e.prev=12,e.t0=e.catch(6),console.error(e.t0);case 15:l=a.width||0,r=a.height||0,e.next=21;break;case 19:l=t.sizes.full.width,r=t.sizes.full.height;case 21:if(null==t.sizes.large){e.next=30;break}return m={url:t.sizes.large.url,scaleList:[.75,1.5,2],originalWidth:l,originalHeight:r},d=O(m),u=d[0]||{},c=d[1]||{},h=d[2]||{},e.next=29,Promise.all([E(u.url),E(c.url),E(h.url)]);case 29:o=e.sent;case 30:g=[],null!=t.sizes.thumbnail&&t.sizes.thumbnail.url&&g.push({url:t.sizes.thumbnail.url,width:t.sizes.thumbnail.width,height:t.sizes.thumbnail.height}),null!=t.sizes.medium&&t.sizes.medium.url&&g.push({url:t.sizes.medium.url,width:t.sizes.medium.width,height:t.sizes.medium.height}),null!=t.sizes.large&&t.sizes.large.url&&(o[0]&&g.push({url:u.url,width:u.width,height:u.height}),g.push({url:t.sizes.large.url,width:t.sizes.large.width,height:t.sizes.large.height}),o[1]&&g.push({url:c.url,width:c.width,height:c.height}),o[1]&&g.push({url:h.url,width:h.width,height:h.height})),g.push({url:t.sizes.full.url,width:t.sizes.full.width,height:t.sizes.full.height}),i&&g.push({url:i,width:l,height:r}),b=parseInt(s),s>=g.length&&(b=g.length-1),p=t.sizes.thumbnail.width!==t.sizes.thumbnail.height?0:1,N({imgId:t.id,imgSizes:g,imgSizeIndex:b.toString(),smallMobileUrl:b-2>=p?g[b-2].url:"",smallMobileWidth:b-2>=p?g[b-2].width:0,smallMobileHeight:b-2>=p?g[b-2].height:0,mobileUrl:b-1>=p?g[b-1].url:"",mobileWidth:b-1>=p?g[b-1].width:0,mobileHeight:b-1>=p?g[b-1].height:0,url:g[b].url,width:g[b].width,height:g[b].height,origWidth:l,origHeight:r,lowestSrcsetImgSizeIndex:p,alt:t.alt});case 40:case"end":return e.stop()}}),e,null,[[6,12]])})))).apply(this,arguments)}var L=function(e){N({figcaption:e})},A=[];return r.forEach((function(e,t){A.push({value:t.toString(),label:e.width+"x"+e.height+(e.width===e.height?" "+u("(Square format)","bsx-blocks"):"")})})),[Object(o.createElement)(g,null,Object(o.createElement)(w,{title:u("Image Size","bsx-blocks")},Object(o.createElement)(x,{label:u("Image size and format","bsx-blocks"),selected:s.toString(),options:A,onChange:function(e){N({imgSizeIndex:e.toString(),smallMobileUrl:e-2>=W?r[e-2].url:"",smallMobileWidth:e-2>=W?r[e-2].width:0,smallMobileHeight:e-2>=W?r[e-2].height:0,mobileUrl:e-1>=W?r[e-1].url:"",mobileWidth:e-1>=W?r[e-1].width:0,mobileHeight:e-1>=W?r[e-1].height:0,url:r[e].url,width:r[e].width,height:r[e].height})}}),null!=r[s]&&null!=r[s].url&&Object(o.createElement)("div",{class:"components-base-control"},Object(o.createElement)("a",{href:r[s].url,target:"_blank"},u("Preview selected image","bsx-blocks"))),Object(o.createElement)(f,{label:u("Displayed image width","bsx-blocks"),value:I,onChange:function(e){N({width:e})}}),Object(o.createElement)(f,{label:u("Displayed image height","bsx-blocks"),value:H,onChange:function(e){N({height:e})}}))),Object(o.createElement)("div",{className:t},l?Object(o.createElement)("figure",{"data-img-size":s},Object(o.createElement)("picture",null,c&&Object(o.createElement)("source",{media:"(max-width: 459.98px)",srcset:c,width:h,height:b}),y&&Object(o.createElement)("source",{media:c?"(max-width: 767.98px)":"(max-width: 459.98px)",srcset:y,width:S,height:k}),Object(o.createElement)("img",{className:"img-fluid upload-img",src:M,alt:C}))):Object(o.createElement)("div",{className:"bsxui-img-upload-placeholder"},Object(o.createElement)(d,{onSelect:T,allowedTypes:"image",value:l,render:function(e){var t=e.open;return Object(o.createElement)(p,{onClick:t,isSecondary:!0},u("Select / upload Image","bsx-blocks"))}})),P&&!m.isEmpty(P)&&Object(o.createElement)(m,{tagName:"figcaption",multiline:!1,placeholder:u("Caption (optional)","bsx-blocks"),value:P,onChange:L,keepPlaceholderOnFocus:!0}),U&&Object(o.createElement)("div",{class:"bsxui-isselected-config-panel"},!P&&m.isEmpty(P)&&Object(o.createElement)(m,{tagName:"figcaption",multiline:!1,placeholder:u("Caption (optional)","bsx-blocks"),value:P,onChange:L,keepPlaceholderOnFocus:!0}),l&&Object(o.createElement)("div",{className:"bsxui-upload-btn-wrapper"},Object(o.createElement)(d,{onSelect:T,allowedTypes:"image",value:l,render:function(e){var t=e.open;return Object(o.createElement)(p,{onClick:t,isSecondary:!0},u("Change / upload Image","bsx-blocks"))}})),Object(o.createElement)(f,{label:u("Alt","bsx-blocks"),value:C,onChange:function(e){N({alt:e})}})))]},save:function(e){var t=e.className,i=e.attributes,l=(i.imgSizeIndex,i.imgSizes,i.smallMobileUrl),n=i.smallMobileWidth,r=i.smallMobileHeight,a=i.mobileUrl,s=i.mobileWidth,u=i.mobileHeight,c=i.url,h=i.width,d=i.height,g=(i.origWidth,i.origHeight,i.alt),b=i.figcaption;return Object(o.createElement)("div",{className:t},c&&Object(o.createElement)("figure",null,Object(o.createElement)("script",null,"document.write( '",Object(o.createElement)("picture",null,l&&Object(o.createElement)("source",{media:"(max-width: 459.98px)",srcset:"","data-srcset":l,"data-width":n,"data-height":r}),a&&Object(o.createElement)("source",{media:l?"(max-width: 767.98px)":"(max-width: 459.98px)",srcset:"","data-srcset":a,"data-width":s,"data-height":u}),Object(o.createElement)("img",{className:"img-fluid",src:"",alt:g,"data-src":c,width:h,height:d,"data-fn":"lazyload"})),"' );"),Object(o.createElement)("noscript",null,Object(o.createElement)("img",{className:"img-fluid",src:c,alt:g,width:h,height:d})),b&&!m.isEmpty(b)&&Object(o.createElement)(m.Content,{tagName:"figcaption",className:"font-italic",value:b})))}})}]);